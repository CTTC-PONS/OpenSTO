{
  "name": "ssh-block-service",
  "id": "ff3f56fb-1605-4225-91c2-ec5220f11d22",
  "href": "",
  "sls": {
    "description": "Service Level Specification for blocking SSH access to a designated service",
    "name": "ssh-block-service",
    "validFor": {
      "startDateTime": "2024-04-08T09:13:16-07:00",
      "endDateTime": "2026-04-08T09:16:19-07:00"
    },
    "relatedServiceLevelObjective": [
      {
        "id": "id_slo_block_ssh",
        "name": "SSH connection attempts blocked",
        "conformanceComparator": ">=",
        "conformanceTarget": "99.99",
        "conformancePeriod": {
          "startDateTime": "2024-04-08T09:13:16-07:00",
          "endDateTime": "2026-04-08T09:16:19-07:00"
        },
        "thresholdTarget": "100",
        "toleranceTarget": "0.01",
        "tolerancePeriod": {
          "startDateTime": "00:00:00",
          "endDateTime": "23:59:59"
        },
        "graceTimes": "0",
        "validFor": {
          "startDateTime": "2024-04-08T09:13:16-07:00",
          "endDateTime": "2026-04-08T09:16:19-07:00"
        },
        "serviceLevelObjectiveParameter": {
          "name": "percentage_blocked",
          "parameterType": "KPI",
          "serviceParmCategory": "service specific",
          "serviceParmPerspective": "single",
          "transformationAlgorithmOfKQI": "KeepTheSame",
          "validFor": {
            "startDateTime": "2024-04-08T09:13:16-07:00",
            "endDateTime": "2026-04-08T09:16:19-07:00"
          }
        },
        "serviceLevelObjectiveConsequence": {
          "prescribedAction": "ALERT security-team@company.tld",
          "validFor": {
            "startDateTime": "2024-04-08T09:13:16-07:00",
            "endDateTime": "2026-04-08T09:16:19-07:00"
          }
        }
      }
    ]
  },
  "policies": [
    {
      "i2nsf-cfi-policy": {
        "name": "secure-http-icmp",
        "rules": [
          {
            "name": "deny-http-from-internet-to-server",
            "condition": {"firewall": {
              "source": "internet", "destination": "server", "transport-layer-protocol": "tcp",
              "destination-range-port-number": {"start-port-number": 80, "end-port-number": 80}
            }},
            "action": {"primary-action": {"action": "drop"}}
          },
          {
            "name": "deny-http-from-server-to-internet",
            "condition": {"firewall": {
              "source": "server", "destination": "internet", "transport-layer-protocol": "tcp",
              "source-range-port-number": {"start-port-number": 80, "end-port-number": 80}
            }},
            "action": {"primary-action": {"action": "drop"}}
          },
          {
            "name": "deny-icmp-from-internet-to-server",
            "condition": {"firewall": {"source": "internet", "destination": "server", "icmp": {}}},
            "action": {"primary-action": {"action": "drop"}}
          },
          {
            "name": "deny-icmp-from-server-to-internet",
            "condition": {"firewall": {"source": "server", "destination": "internet", "icmp": {}}},
            "action": {"primary-action": {"action": "drop"}}
          },

          {
            "name": "permit-http-from-corporate-to-server",
            "condition": {"firewall": {
              "source": "corporate", "destination": "server", "transport-layer-protocol": "tcp",
              "destination-range-port-number": {"start-port-number": 80, "end-port-number": 80}
            }},
            "action": {"primary-action": {"action": "pass"}}
          },
          {
            "name": "permit-http-from-server-to-corporate",
            "condition": {"firewall": {
              "source": "server", "destination": "corporate", "transport-layer-protocol": "tcp",
              "source-range-port-number": {"start-port-number": 80, "end-port-number": 80}
            }},
            "action": {"primary-action": {"action": "pass"}}
          },
          {
            "name": "permit-icmp-from-corporate-to-server",
            "condition": {"firewall": {"source": "corporate", "destination": "server", "icmp": {}}},
            "action": {"primary-action": {"action": "pass"}}
          },
          {
            "name": "permit-icmp-from-server-to-corporate",
            "condition": {"firewall": {"source": "server", "destination": "corporate", "icmp": {}}},
            "action": {"primary-action": {"action": "pass"}}
          }
        ],
        "endpoint-groups": {
          "device-group": [
            {"name": "internet",  "ipv4": "0.0.0.0/0"     },
            {"name": "server",    "ipv4": "192.168.0.0/24"},
            {"name": "corporate", "ipv4": "192.168.1.0/24"}
          ]
        }
      }
    }
  ]
}
